<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOOP 엑셀 방송 점수 집계</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
          <rect width="40" height="40" rx="8" fill="url(#gradient)"/>
          <path d="M12 20L18 26L28 14" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          <defs>
            <linearGradient id="gradient" x1="0" y1="0" x2="40" y2="40">
              <stop offset="0%" stop-color="#667eea"/>
              <stop offset="100%" stop-color="#764ba2"/>
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1>SOOP 엑셀 방송 점수 집계</h1>
      <p class="subtitle">실시간 방송 점수를 자동으로 집계합니다</p>
    </header>

    <main class="main">
      <!-- URL 입력 섹션 -->
      <section class="input-section">
        <div class="input-group">
          <label for="url-input">방송 URL</label>
          <div class="input-wrapper">
            <input 
              type="text" 
              id="url-input" 
              placeholder="https://play.soop.tv/example123"
              autocomplete="off"
            >
            <button id="start-btn" class="btn-primary">
              <span class="btn-text">집계 시작</span>
              <span class="btn-icon">🚀</span>
            </button>
          </div>
          <p class="input-hint">SOOP(아프리카TV) 방송 URL을 입력해주세요</p>
        </div>

        <!-- 옵션 설정 -->
        <div class="options-toggle">
          <button id="options-btn" class="btn-text-only">
            <span>고급 옵션</span>
            <svg class="chevron" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M4 6l4 4 4-4"/>
            </svg>
          </button>
        </div>

        <div class="options-panel" id="options-panel">
          <div class="option-item">
            <label for="capture-count">캡처 횟수</label>
            <input type="number" id="capture-count" value="5" min="1" max="20">
            <span class="option-hint">화면을 캡처할 횟수</span>
          </div>
          <div class="option-item">
            <label for="capture-interval">캡처 간격 (초)</label>
            <input type="number" id="capture-interval" value="3" min="1" max="10">
            <span class="option-hint">캡처 사이의 대기 시간</span>
          </div>
          <div class="option-item">
            <label for="chat-duration">채팅 모니터링 (초)</label>
            <input type="number" id="chat-duration" value="30" min="10" max="120">
            <span class="option-hint">채팅을 모니터링할 시간</span>
          </div>
        </div>
      </section>

      <!-- 진행 상태 -->
      <section class="progress-section" id="progress-section" style="display: none;">
        <div class="progress-card">
          <div class="progress-header">
            <h3>집계 진행 중...</h3>
            <div class="spinner"></div>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
          </div>
          <div class="progress-logs" id="progress-logs">
            <p class="log-item">🚀 브라우저 초기화 중...</p>
          </div>
        </div>
      </section>

      <!-- 결과 섹션 -->
      <section class="results-section" id="results-section" style="display: none;">
        <div class="results-header">
          <h2>📊 집계 결과</h2>
          <div class="results-meta">
            <span id="participant-count">참가자: 0명</span>
            <span id="timestamp">집계 시간: -</span>
          </div>
        </div>

        <div class="results-table-wrapper">
          <table class="results-table">
            <thead>
              <tr>
                <th>순위</th>
                <th>이름</th>
                <th>점수</th>
              </tr>
            </thead>
            <tbody id="results-tbody">
              <!-- 결과가 여기에 동적으로 추가됩니다 -->
            </tbody>
          </table>
        </div>

        <div class="results-actions">
          <button id="download-btn" class="btn-secondary">
            <span>결과 다운로드 (JSON)</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M8 12L3 7h3V2h4v5h3l-5 5z"/>
              <path d="M2 14h12v2H2z"/>
            </svg>
          </button>
          <button id="reset-btn" class="btn-secondary">
            <span>새로 집계하기</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M13.65 2.35A7.95 7.95 0 008 0a8 8 0 00-8 8h2a6 6 0 0110.39-4.24L10 6h6V0l-2.35 2.35z"/>
            </svg>
          </button>
        </div>

        <!-- 스크린샷 갤러리 -->
        <div class="screenshots-section">
          <h3>📸 캡처된 화면</h3>
          <div class="screenshots-grid" id="screenshots-grid">
            <!-- 스크린샷이 여기에 동적으로 추가됩니다 -->
          </div>
        </div>
      </section>

      <!-- 에러 섹션 -->
      <section class="error-section" id="error-section" style="display: none;">
        <div class="error-card">
          <div class="error-icon">⚠️</div>
          <h3>집계 실패</h3>
          <p id="error-message">알 수 없는 오류가 발생했습니다.</p>
          <button id="error-retry-btn" class="btn-primary">다시 시도</button>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Made with ❤️ for SOOP Streamers</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
